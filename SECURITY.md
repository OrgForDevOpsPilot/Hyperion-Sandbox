# セキュリティ対応方針（開発者向け）

本リポジトリでは、GitHub Advanced Security を活用し、コードベースに対して継続的なセキュリティチェックを行っています。  
Dependabot、シークレットスキャン、コードスキャン（CodeQL）からのアラートを受け取った際には、以下の方針に従って対応してください。

---

## 1. 対象バージョンとサポート方針

本リポジトリでは以下のバージョンに対してセキュリティ修正を提供しています：

| バージョン | サポート状況       |
| ---------- | ------------------ |
| 5.1.x      | ✅ サポート中       |
| 5.0.x      | ❌ サポート終了     |
| 4.0.x      | ✅ サポート中       |
| 4.0 未満   | ❌ サポート終了     |

---

## 2. セキュリティアラートへの対応手順

### 2.1 Dependabot アラート（依存関係の脆弱性）

- Pull Request（自動生成）が出ている場合は、**CIが通ることを確認し、内容をレビューのうえ速やかにマージ**してください。
- CIを通すのが困難な場合や影響範囲が大きい場合は、以下を考慮の上でトリアージしてください：
  - 該当パッケージの使用箇所の特定と影響範囲の確認
  - 該当バージョンでの脆弱性の深刻度（CVSSスコア等）の確認
- 対応が困難な場合は、`SECURITY-LABEL:Exception` ラベルを付けて、理由をコメントで明記し、週次のセキュリティレビューで相談してください。

### 2.2 シークレットスキャン（Secret Scanning）

- プッシュ保護（Push Protection）でブロックされた場合は、**即時にコミットを中止**し、対象のシークレット（例：トークンやパスワード）を以下の手順で対応してください：
  1. **該当シークレットの無効化・再発行**
  2. **`.git` 履歴からの削除（BFG や filter-repo 等）**
  3. **GitHubへ再プッシュ**

- アラートが出た場合は、上記と同様に対応し、必要に応じてアプリケーション側の設定も更新してください。

### 2.3 コードスキャン（Code Scanning / CodeQL）

- アラートの詳細を確認し、該当コードが本当に脆弱であるかを判断してください。
- **Copilot Autofixの提案**がある場合は、修正内容をレビューし、問題なければ取り込みます。
- 以下の観点でトリアージしてください：
  - 誤検知ではないか？
  - アクセス可能な経路があるか？
  - 修正が困難な場合、ワークアラウンドやガード条件の導入が可能か？

- 修正できない場合や修正方針に迷う場合は、`SECURITY-LABEL:ReviewNeeded` をつけ、担当セキュリティリードまたはリード開発者に相談してください。

---

## 3. 定期的なセキュリティ確認

- 毎週のセキュリティレビュー（セキュリティチーム or プロジェクト横断チーム）にて、未対応アラートの棚卸しと優先順位づけを実施します。
- 開発チーム内で **週1回は Dependabot / CodeQL のアラートを確認**してください。

---

## 4. 問い合わせ先

セキュリティに関する質問・相談・例外申請は以下までご連絡ください：

📩 security-team@internal.example.com  
🔧 Slack: `#security-alerts` チャンネル

---

※このドキュメントはプロジェクトのセキュリティ対応方針を記載したものであり、各プロジェクトで適宜カスタマイズしてご利用ください。
